# `causepid`: example codes for "Causal Inference for Epidemic Models" [[1](#BVW25)]

This repository consists of 
1. the data from Delphi COVIDcast ([[3](#Delphi21)]), analyzed in [[1](#BVW25)] and [[2](#BVW24)]. 
2. the IPython notebooks of the reproducible code scripts for the simulations and the COVID-19 data analysis in [[1](#BVW25)].

## Prerequisite
Some code scripts in this repository require installation of the [`freqepid`](https://github.com/HeejongBong/freqepid) Python package.

## Simulation using semi-mechanistic model (Section 7.1, [[1](#BVW25)])
The relevant files are available in `/simulation_semi/`. We considered two scenarios (i) where there was no phantom variable and (ii) where there was a phantom variable. The data were generated by the code scripts `Simulation Data - no phantom.ipynb` and `Simulation Data - no phantom.ipynb` under scenarios (i) and (ii), respectively. The exact copy of the simulation data for the figures in the paper is available in `/simulation_semi/data/`. The code scripts for the analyses are
- `Simulation Study - no phantom - ML.ipynb`: the maximum likelihood estimation (Method 1) under scenario (i), which generates Fig. S1.
- `Simulation Study - phantom - ML.ipynb`: the maximum likelihood estimation (Method 1) under scenario (ii), which generates Fig. 5(a).
- `Simulation Study - phantom - EE.ipynb`: the proposed estimating equation approach (Method 3) under scenario (iii), which generates Fig. 5(b).

## Simulation using SEIR model (Section 7.2, [[1](#BVW25)])
The relevant files are available in `/simulation_seir/`. We considered only the case where there was a phantom variable. The data were generated by the code script `Simulation Data - no phantom.ipynb`. The exact copy of the simulation data for the figures in the paper is available in `/simulation_seir/data/`. The code scripts for the analyses are
- `Simulation Study - phantom - ML.ipynb`: the maximum likelihood estimation (Method 1), which generates Fig. 6(a).
- `Simulation Study - phantom - EE.ipynb`: the proposed estimating equation approach (Method 3), which generates Fig. 6(b).

## COVID-19 data analysis (Section 7.3, [[1](#BVW25)])
The relevant files are available in `/delphi_covidcast/`. The data are available in `/delphi_covidcast/data/CovidCastStateAdj_2.feather`. The original data are obtained via the [Delphi Epidata API](https://cmu-delphi.github.io/delphi-epidata/api/covidcast.html). A preprocessing step was used to correct for the weekend effect, which shows fewer deaths reported on Saturdays and Sundays. See [[2](#BVW24)] and the code scripts in [`freqepid`](https://github.com/HeejongBong/freqepid) for further details. The code scripts for the analyses are
- `Data Analysis - delphi - EE.ipynb`: the proposed estimating equation approach (Method 3), which generates Fig. 7(a).
- `Data Analysis - delphi - ML.ipynb`: the maximum likelihood estimation (Method 1), which generates Fig. 7(b).

## References

<a name="BVW25"> [1] Bong, H., Ventura, V., & Wasserman, L. (2025+). Causal Inference for Epidemic Models. Submitted. </a>

<a name="BVW24"> [2] Bong, H., Ventura, V., & Wasserman, L. (2024). Frequentist inference for semi-mechanistic epidemic models with interventions. *Journal of the Royal Statistical Society Series B: Statistical Methodology,* qkae110. </a>

<a name="Delphi21"> [3] Reinhart, A., Brooks, L., Jahja, M., Rumack, A., Tang, J., Agrawal, S., ... & Tibshirani, R. J. (2021). An open repository of real-time COVID-19 indicators. *Proceedings of the National Academy of Sciences, 118(51),* e2111452118. </a>
